<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Status Time Line</title>
        <style>


            body {
                background-color : rgb(44,44,44);
            }

            h1, h2 {
                color: white;
            }

            #chart-container-1 {
                display: block;
                height:40px;
                width: 100%;
                background-color: rgba(0, 0, 0, 0.2);
            }

            #chart-container-2 {
                display: block;
                height: 50px;
                width: 100%;
                background-color: rgba(0, 0, 0, 0.2);
            }


            .container {
                width: 85%;
                margin: 0 auto;
            }

            .legend {
                display:flex;
                display:-ms-flexbox;
                flex-direction:row;
                justify-content:space-between;
                position:relative;
                margin-top: 5px;
            }

            .legend .spacer{flex:1;margin:0.5rem 1rem 0 1rem;height:1px;background:#aaa;opacity:0.3}
            .legend .legend-item.light{color:#aaa;opacity:0.5}
            .legend .legend-item{flex:0 0 auto;font-size:.875rem;position:relative;color:#aaa;opacity:0.8}

            /* .tooltip { background: #eee;
            box-shadow: 0 0 5px #999999;
            color: #333;
            display: none;
            font-size: 12px;
            left: 130px;
            padding: 10px;
            position: absolute;
            text-align: center;
            top: 95px;
            width: 80px;
            z-index: 10; } */

            div.tooltip {
                position: absolute;
                /* transform-origin: bottom center; */
                text-align: center;
                padding: 5px;
                font: 12px sans-serif;
                background: lightgray;
                border: 0px;
                border-radius:4px;
                pointer-events: none;
            }

            .tooltip {
                width: 140px;
                margin-left: -75px;
                margin-top: 5px;
            }

            .axis {
              display: none;
            }

            .tooltip::after {
            content: " ";
            position: absolute;
            bottom: 100%; /* At the bottom of the tooltip */
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color:  transparent transparent lightgray transparent;
            }


        </style>
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <script src="/dist/wb-charts.umd.js"></script>
        <link rel="stylesheet" href="/dist/wb-charts-dark.css">
    </head>
    <body>
        <div class="container">
        <h1>Beschikbaarheid gevalideerde metingen Kalman stations</h1>
        <h2>Aberdeen - Waterlevel</h2>
        <div id="chart-container-2"></div>
        <div class="legend">
            <div class="legend-item light legend-item-date-range"><span class="availability-time-line-legend-day-count">24</span> uur geleden</div>
            <div class="spacer"></div>
            <div class="legend-item legend-item-uptime-value legend-item-qsvz65tgphcn"><span id="uptime-percent-qsvz65tgphcn">85</span> % beschikbaar</div>
            <div class="spacer"></div>
            <div class="legend-item light legend-item-date-range">Nu</div>
          </div>
        <h2>Dover - Waterlevel</h2>
        <div id="chart-container-1"></div>
        <div class="legend">
            <div class="legend-item light legend-item-date-range"><span class="availability-time-line-legend-day-count">24</span> uur geleden</div>
            <div class="spacer"></div>
            <div class="legend-item legend-item-uptime-value legend-item-qsvz65tgphcn"><span id="uptime-percent-qsvz65tgphcn">85</span> % beschikbaar</div>
            <div class="spacer"></div>
            <div class="legend-item light legend-item-date-range">Nu</div>
          </div>
    <h2>Last update: 27 aug  15:00</h2>
</div>

        <script type="text/javascript">

const colorMap = function( value ) {
    const colors ={
        "validated" : "#2fcc66", 
        "filled" : "#1e7b3f",
        "warning": "yellow",
        "error": "red",
        "unvalidated": "grey"
    }
    return colors[value];
}

// set constants
var container1= document.getElementById("chart-container-1");
var axis1 = new wbCharts.CartesianAxis(container1, null, null,
  {
    margin: {top: 0, left: 0, right: 0, bottom: 0},
    x : [ {type: 'band', position: 'top' } ],
    y : [ {type: 'band' } ],
  }
);


var container2 = document.getElementById("chart-container-2");
var axis2 = new wbCharts.CartesianAxis(container2, null, null,
  {
    margin: {top: 0, left: 0, right: 0, bottom: 0},
    x : [ {type: 'band', position: 'top' } ],
    y : [ {type: 'band' } ],
  }
);

d3.json("available.json").then((data) => {
  var plotMatrix1 = new wbCharts.ChartMatrix(data,
    {
        x: { paddingOuter: 0, paddingInner: 0.4},
        y: { paddingOuter: 0, paddingInner: 0},
        color: { map: colorMap}
    });
  plotMatrix1.addTo(axis1,
    {
        x: { key: "date", axisIndex: 0},
        y: { key: "series", axisIndex: 0 },
        color: {key: 'value'}
  }, 'matrix', {
  });

  axis1.redraw({});
});

d3.json("available_aberdeen.json").then((data) => {

  var plotMatrix2 = new wbCharts.ChartMatrix(data,
    {
        x: {paddingOuter: 0, paddingInner: 0.4},
        y: { paddingOuter: 0, paddingInner: 0.1},
        color: { map: colorMap}
    });
  plotMatrix2.addTo(axis2, { x: { key: "date", axisIndex: 0}, y: {key: "series", axisIndex: 0 }, color: {key: 'value'}
  }, 'matrix', {
  });

  axis2.redraw({});
});


        window.onresize = function(){axis1.resize(); axis2.resize()};



        </script>


    </body>
</html>
